<<<<<<< SEARCH
  updateStatus(
    callId: string,
    status: 'awaiting_approval',
    data:
      | ToolCallConfirmationDetails
      | {
          correlationId: string;
          confirmationDetails: SerializableConfirmationDetails;
        },
  ): void;
=======
  updateStatus(
    callId: string,
    status: 'awaiting_approval',
    data: {
      correlationId: string;
      confirmationDetails: SerializableConfirmationDetails;
    },
  ): void;
>>>>>>> REPLACE
<<<<<<< SEARCH
    let confirmationDetails:
      | ToolCallConfirmationDetails
      | SerializableConfirmationDetails;
    let correlationId: string | undefined;

    if (this.isEventDrivenApprovalData(data)) {
      correlationId = data.correlationId;
      confirmationDetails = data.confirmationDetails;
    } else {
      // TODO: Remove legacy callback shape once event-driven migration is complete
      confirmationDetails = data as ToolCallConfirmationDetails;
    }

    return {
      request: call.request,
      tool: call.tool,
      status: 'awaiting_approval',
      correlationId,
      confirmationDetails,
      startTime: 'startTime' in call ? call.startTime : undefined,
      outcome: call.outcome,
      invocation: call.invocation,
    };
=======
    if (!this.isEventDrivenApprovalData(data)) {
      throw new Error(
        `Invalid data for 'awaiting_approval' transition (callId: ${call.request.callId})`,
      );
    }

    return {
      request: call.request,
      tool: call.tool,
      status: 'awaiting_approval',
      correlationId: data.correlationId,
      confirmationDetails: data.confirmationDetails,
      startTime: 'startTime' in call ? call.startTime : undefined,
      outcome: call.outcome,
      invocation: call.invocation,
    };
>>>>>>> REPLACE
